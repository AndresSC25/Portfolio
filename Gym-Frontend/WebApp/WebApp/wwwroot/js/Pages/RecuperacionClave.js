function UsersViewController() {
    this.ViewNameUsers = "Users";
    this.ApiBaseEndPointUser = "User";
    this.ViewNameRol = "Passwords";
    this.ApiBaseEndPointRol = "Password";

    this.InitView = function() {
        console.log("User view init!!!");

        //Bind del click
        $("#btnGetNewP").click(function() {
            var selectedRol = $("#emailtxt").val();

            if (selectedRol === "") {
                Swal.fire({
                    icon: "error",
                    title: "Oops...",
                    text: "Por favor, Ingrese su email."
                });
                return false;
            } else {
                var vc = new UsersViewController();
                vc.Create();
            }
        });


    };

    this.Create = function() {


        var userEmail = $("#emailtxt").val();
        var ca = new ControlActions();
        ca.GetToApi("User/" + "RetrieveByEmail?email=" + userEmail,
            (response) => {

                if (!response || response.id === 0) {
                    Swal.fire({
                        icon: "error",
                        title: "Oops...",
                        text: "El usuario con el correo electrónico ingresado no existe.",
                        footer: "SILUETA CLUB FITNESS"
                    });
                    return;
                }


                var password = {
                    id: 0,
                    userId: response.id,
                    passwordContent: "",
                    created: "2024-07-28T00:31:11.770Z"
                };

                var endPointRoute = "Password/AutoGeneratedPassword";


                ca.PostToAPI(endPointRoute,
                    password,
                    (data, errorType) => {
                        if (errorType) {
                            Swal.fire({
                                icon: "error",
                                title: "Oops...",
                                html: `<b>Error: ${errorType}</b><br/>Ocurrió un error al crear la contraseña.`,
                                footer: "SILUETA CLUB FITNESS"
                            });
                        } else {
                            Swal.fire({
                                    icon: "success",
                                    title: "¡Éxito!",
                                    text: "Se ha creado una nueva contraseña para el usuario.",
                                    footer: "SILUETA CLUB FITNESS"
                                })
                                .then(() => { window.location.href = "Menu"; });

                        }
                    }
                );
            },
            (errorType) => {
                Swal.fire({
                    icon: "error",
                    title: "Oops...",
                    html: `<b>Error: ${errorType}</b><br/>Ocurrió un error al buscar el usuario.`,
                    footer: "SILUETA CLUB FITNESS"
                });
            }
        );
    };


}

$(document).ready(function() {
    var vc = new UsersViewController();
    vc.InitView();
});